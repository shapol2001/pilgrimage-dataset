function renderNetwork() {
  if (!checkData()) return;

  const nodes = [];
  const edges = [];
  const nodeSet = new Set();

  window.pilgrimsData.forEach(r => {
    const author = r["Автор"]?.trim();
    const journal = r["Журнал"]?.trim();
    if (!author || !journal) return;

    // Узлы авторов
    if (!nodeSet.has(author)) {
      nodes.push({
        id: author,
        label: author,             // подпись
        group: "author",
        shape: "dot",
        size: 20,
        font: { size: 14, color: "#000", face: "Arial" } // явный шрифт и размер
      });
      nodeSet.add(author);
    }

    // Узлы журналов
    if (!nodeSet.has(journal)) {
      nodes.push({
        id: journal,
        label: journal,           // подпись
        group: "journal",
        shape: "square",
        size: 20,
        font: { size: 14, color: "#000", face: "Arial" }
      });
      nodeSet.add(journal);
    }

    edges.push({ from: author, to: journal });
  });

  const container = document.getElementById("network");
  const data = { nodes: new vis.DataSet(nodes), edges: new vis.DataSet(edges) };
  const options = {
    physics: {
      enabled: true,
      barnesHut: {
        gravitationalConstant: -30000,
        centralGravity: 0.1,
        springLength: 150,
        springConstant: 0.02
      }
    },
    nodes: {
      borderWidth: 1,
      shadow: true,
      font: { size: 14, color: "#000", face: "Arial" }, // подписи видны
      scaling: { min: 10, max: 30 }
    },
    edges: {
      smooth: true,
      color: { color: "#888" }
    }
  };
  new vis.Network(container, data, options);
}
